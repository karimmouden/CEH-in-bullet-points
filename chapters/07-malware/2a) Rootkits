
Rootkits :

      - malicious software
      - permits a legitimate user to have confidential access to
              - a system
              - privileged areas of its software.
      - stays hidden in the computer

      - Powerful Backdoor
      - Unlike Backdoors, Rootkit Cannot be detected by observing :
          - Registry
          - System Task List
          - Services

      - Blended threats typically consist of 3 snippets of code:

                - Dropper :  Executable that installs the rootkit
                             Deletes itself after lauching Loader

                - Loader :   Launched by Dropper
                             Causes buffer overflow => Rootkit Loaded into Memory

                - Rootkit : Backdoor loaded into Memory by Loader

      -  Ring 3 level (Application)  Rootkit :
              -> Superficial infection
                 Infect only programs such as Microsoft Office, Photoshop ..

      - Ring 1 and 2 (Drivers) Infection :
              -> deeper layers, such as the drivers for :
                          - video graphics card,
                          - sound system.

      - Ring 0 (Kernel) Rootkit:
          -> targets the base OS that controls everything else, such as the BIOS or CMOS.
             deepest and hardest to remove since
                antivirus (which mostly operates at Ring 3) doesn’t have full access to Ring 1.


--------------------------------------------------------------------------------------------------
          1. KERNEL rootkit: (Ring 0)

                - operates at the OS level
                      => difficult to detect
                - can effectively
                        add new code to the OS,
                        delete and replace OS code.
                          => can damage seriously OS
                - heavily impacts performance
                - advanced & complex pieces of malware
                - require advanced technical knowledge to properly create one
--------------------------------------------------------------------------------------------------
          2. FIRMWARE Rootkit: (Ring 1)

              - target software(firmware) that runs certain hardware components like :
                          - network devices

              - Booted when machines get booted
              &
              - stay in the device forever.

              => very difficult to detect
--------------------------------------------------------------------------------------------------
          3. APPLICATION Rootkit: (Ring 3)

              - infect the application files inside the computer.
              - The application files are replaced
                                                by rootkit files
                      or
                the behaviour of the application is changed
                                                 due to code injected.
--------------------------------------------------------------------------------------------------
          4. MEMORY rootkit:

              - hide in the RAM memory of your computer. (RAM : Random Access Memory)
              - operate from the computer memory.
              - have a short lifespan :
                    -  live in your computer’s RAM
                    -  will disappear once you reboot your system — though sometimes further work is required to get rid of them.
              - Like kernel rootkits,
                   - can reduce the performance of your RAM memory,
                      by occupying the resources with all the malicious processes involved.

--------------------------------------------------------------------------------------------------
          5. BOOTKIT rootkits:

            - BOOT LOADER rootkit
            - infects :
                  - master boot record (MBR)
               or
                  - volume boot record (VBR).

                        =>   rootkit won’t show up in the standard file system view.

                                => hard to detect by antivirus & anti-rootkit

            - infect the authentic BOOT LOADER of the computer with the corresponding rootkit

            - boots up at the same time as your OS

///////////////////////////////////
            BIOS/MBR Boot Process:

              1- BIOS : PC is turned on
                        BIOS initializes Hardware

              2- BIOS calls stored code in MBR at the start of Disk 0 (sector 0)

              3- MBR Loads code from BOOTSECTOR of active Partition

              4- BOOTSECTOR loads & runs BOOTLOADER from its filesystem


        - MBR : Master Boot Record (sector 0)
                1st sector of Computer Hard Drive
                tells computer:
                    - how Hard Drive is Partitioned
                    - how to load OS

        - BOATLOADER :
                - Software
                - built into most modern OS by default.
                - transfer to the main memory RAM :
                    - Boot DATA of the installed OS :
                        - Data required for the boot process of OS
                          that must be
                            preloaded into the main memory when the device starts up.

                - Windows, macOS and others are thus
                    - equipped with an ad hoc function allowing
                            - management of  processes
                            - access of the processor to the main memory.

--------------------------------------------------------------------------------------------------

          6. HYPERVIZOR / VIRTUALIZED rootkit : (Ring 0)

                  - are a new development
                  - takes advantage of new technologies.
                  - Security researchers developed in 2006 1st such rootkit as "proof of concept"

                  - More powerful than a kernel rootkit :
                       -  KERNEL rootkit will boot-up at the SAME TIME as  OS
                       -  VIRTUALIZED rootkit will
                                          1) boot-up FIRST,
                                          2) create a Virtual Machine
                                          3) and only then let OS boot up.

                  - have even more control over your system than a kernel one.
                  - removal can be nearly impossible.
                         because they bury themselves so deep within the device.

                  - To give you a visual sense of this, imagine the rootkit and the boot-up process as if they were two boxes.

                  In a kernel rootkit:
                          the 1st box is the boot-up process.
                          The rootkit is the 2nd box, that goes inside the 1st box.

                  In a virtualized rootkit :
                          the 1st box is the rootkit itself.
                          The boot-up process is the 2nd box that goes within the 1st box.

--------------------------------------------------------------------------------------------------
