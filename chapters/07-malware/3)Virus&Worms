
Worm :

  - standalone (autonomous) malicious programs
        - replicate,
        - execute,
        - spread
        
    across "network connections",
        
        - independently,
        - without human intervention.

  - consume available computing resources (network servers, web servers...)
          - become overloaded
          - stop responding.
  However, some worms also carry a payload to damage the host system.

--------------------------------------------------------------------------------------------------

Virus :

      - ATTACH themselves to programs
      
      - transmit themselves to other programs
                  by making use of specific events.

      - to activate :
      
            - TRIGGER event
          or
            - DIRECT ATTACK

      - attack :
                 - system’s built-in programs,
                 - antivirus software,
                 - data files,
                 - system startup settings ..

--------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------

Virus Types :

--------------------------------------------------------------------------------------------------
        1) Boot sector virus (System)


                  Step1 :  Moves MBR	to 	Another location on Hard Disk

                  Step2 :  Copies itself 	to 	MBR Original Location

                  MBR : Master Boot Record

                  When  system boots

                        1-  Virus Code is executed first

                        2-  Control is passed to original MBR
--------------------------------------------------------------------------------------------------
       2) File Virus :

               - Can be either:
                       - direct-action (non-resident)
                       - memory-reside

               - Infect files which are
                        executed or interpreted in the system such as:

                                    - COM
                                    - EXE
                                    - SYS
                                    - OVL
                                    - OBJ
                                    - PRG
                                    - MNU
                                    - BAT

--------------------------------------------------------------------------------------------------
       3) Multipartite Virus

               - Infect  at the same time :

                           - System boot sector
                           - Executables

               - examples :	
                            - "Invader"
                            - "Flip"
                            - "Tequil"


System boot sector :
  
    - sector of a "persistent data storage device" (e.g., hard disk, floppy disk, optical disc, etc.) 
    
    - contains machine code to be :
            
            - loaded into random-access memory (RAM) 
            
            and 
            
            - then executed by a computer system's built-in firmware (e.g., the BIOS).

MBR : 
  
  - Master Boot Record (MBR)
  
  - record (information)
  
  - information in the 1st sector of any hard disk or diskette 
  
  - identifies how and where an OS is located so that 
  
          - it can loaded into the computer's main storage or random access memory.
          
          
--------------------------------------------------------------------------------------------------
       4) Macro Virus

             - Infect files created by :

                      - Microsoft Word

                      - Microsoft Excel

              - Written using macro language

                        ex: Visual Basic for Applications (VBA)

              - Convert infected documents into template files

                      while maintaining their appearance

                      of ordinary document files


--------------------------------------------------------------------------------------------------
       5) Cluster Virus

                - Modify DTA (Directory Table Entries)

                - DTA Points :
                              - users
                            &
                              - system processes

                        to
                              virus CODE
                              
                        instead of
                              
                              safe program


                - Only 1 copy infects all the programs


                          Step 1:  Launch itself first when
                                                   any program  started

                          Step 2:  Control is passed to safe program

--------------------------------------------------------------------------------------------------
       6) Stealth/Tunneling Virus

       - Evade the anti-virus software

       - Intercepting "A-V requests to OS" used to read infected file


                1- Hide itself

                2- Pass  A-V request (system calls) to
                
                                    virus
                                    
                  instead of
                                    
                                    OS

                3- Virus  returns an 
                    
                      uninfected version of  file to A-V

                => appears "clean"

--------------------------------------------------------------------------------------------------
       7) Encryption Virus

               - Uses simple encryption to encipher code

               - Encrypted with a different key for each infected file

               - Not detected using signature detection method

--------------------------------------------------------------------------------------------------
       8) Sparse Infector Virus (Conditioned)

            - Infects either :

                - Occasionally (e.g. every 10 program executed),

                - Only files whose lengths fall within a narrow range

             - By infecting less often

                =>	Minimize  probability to be  discovered
--------------------------------------------------------------------------------------------------
       9) Polymorphic Virus

             - composed by  2 parts :

                   a- Original Algorithm part

                          - Stays intact

                   b- Mutated Algorithm part

                          - Mutates on each infection


             - Requires Mutation Engine to :

                        - Enable Polymorphic Code

          	- Polymorphic "mutation Engine" can not rewrite its own code
            
--------------------------------------------------------------------------------------------------
      
      10) Metamorphic Virus


       Step 1 :  Translate
                      its own 
                        
                          "binary code"
                      
                              into
                      
                       "temporary representation"

       Step 2 :  Edits  temporary representation of themselves

       Step 3 :  Translate

                      edited representation back

                 to
                      machine code again : binary code



- Rewrite themselves completely 100%

- Even metamorphic "mutation Engine" rewrites its own code

- No part of the virus stays the same

- Each succeeding version of the code is different from the preceding one.

- Each version of metamorphic malware functions the same way.

- Considered  MOST INFECTIOUS computer virus

- More difficult to write than polymorphic malware

- Multiple transformation techniques, including  :

        - Register renaming
        - Code permutation
        - Code expansion
        - Code shrinking
        - Garbage code insertion.

        - Inserting NOP instructions (brute force)
        - Changing what registers to use
        - Changing flow control with jumps
        - Changing machine instructions to equivalent ones
        - Reordering independent instructions.


For example:

 W32/Simile consisted of over 14000 lines of assembly code,

90% of it is part of the metamorphic engine


 The longer the malware stays in a computer,
    the more iterations it produces
    the more sophisticated the iterations are,
=> making it increasingly hard for antivirus applications to
      detect, quarantine and disinfect.

--------------------------------------------------------------------------------------------------
       11) Cavity Virus (Overwriting)

          - "space filler" virus

          - overwrite a part of the file

          - Use constants (usually NULLs )

          - Preserve :

                - Size

                - Functionalities

--------------------------------------------------------------------------------------------------
       12) Companion Virus (Camouflage)

       - Create  companion file for each executable

       - May save itself as notepad.com :

                1- Victim executes notepad.exe 	(good program)

                2- Computer loads notepad.com 	(virus)
--------------------------------------------------------------------------------------------------
       13) Shell Virus

       - Forms a shell around the target host program’s code

       - Makes itself  :
       
          - the original program
      		- host code as its sub-routine

      - Almost all boot program viruses are shell viruses

--------------------------------------------------------------------------------------------------
      
      14) File Extension Virus

       - Change Malicious File Extension

       - Works when Extensions Turned Off

       => File  BAD.TXT.VBS   appears BAD.TXT

       executable Visual Basic Script virus file


       - Countermeasure :  Turn off “Hide file extensions” in Windows.

--------------------------------------------------------------------------------------------------
       15) FAT virus

        - Attacks the "File Allocation Table" (FAT)

        - Cause very serious damage to a computer

        - Destroys  index

              =>	 impossible for a computer to locate files

        - Spread to files when the FAT attempts to access them.

        - Provoke "corruption" to eventually penetrate  entire computer

--------------------------------------------------------------------------------------------------
       16) Logic Bomb Virus


       - Triggered by a response to an event

       - Triggered when a specific date is reached : Time Bomb

--------------------------------------------------------------------------------------------------
       17) Web Scripting Virus

            - Vulnerability through websites

            - Breaches  "web browser security"

            - Inject client-side scripting into  web page

            - Attack sites with large populations such as :

                    - social networking
                    - user review,
                    - email

            - Has 2 different types :

                   - Non-Persistent
                   - Persistent

--------------------------------------------------------------------------------------------------
       18) Email Virus

             -  Spread through e-mail "attachment"

             - Cause some unexpected harmful effect such as :

                          - destroys Hard Disk files
--------------------------------------------------------------------------------------------------
       19) Add-on Virus

       - append virus code to  host code :

             - No change applied to host code
             or
             - Relocate the host code to insert their own code at the beginning
--------------------------------------------------------------------------------------------------

       20) Intrusive Virus

           - Overwrite  host code

                - partiallly
                or
                - completely

             using  viral code


--------------------------------------------------------------------------------------------------
       21) Direct Action Virus (Transient)

       - Transfers
            all controls of  host code
                      to
            its location in  memory


       - Runs  when host code is run


       - Terminates itself
       or
          exits memory

                  as soon as  host code execution ends


--------------------------------------------------------------------------------------------------
       22) TSR Virus (Terminate & Stay Resident)

       - Remains permanently in  memory   during   session
                even after
                    target host code is executed & terminated;

       - Removed only by rebooting  system


--------------------------------------------------------------------------------------------------
