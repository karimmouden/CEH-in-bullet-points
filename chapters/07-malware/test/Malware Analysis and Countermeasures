Malware Analysis and Countermeasures

Marina is a malware analyst with a bank in London. One day,
she suspects a file to be a malware and tries to perform static analysis to identify its nature.
She wants to analyze the suspicious file
and extract the embedded strings in the file into a readable format.
Which of the following tool can she use to perform this task?


ASPack :

    advanced EXE packer created to
          compress Win32 executable files
          Protect them against non-professional reverse engineering.


UPX :

    (Ultimate Packer for Executables)
    Free & open source executable packer
    Supports a number of
          file formats from different OS.

PE Explorer :

     lets you open, view & edit a variety of
          different 32-bit Windows executable file types (also called PE files)
                ranging from
                          the common, such as EXE, DLL and ActiveX Controls,
                        to
                          the less familiar types, such as
                              - SCR (Screensavers),
                              - CPL (Control Panel Applets),
                              - SYS,
                              - MSSTYLES,
                              - BPL,
                              - DPL
                              and more (including executable files that run on
                                        MS Windows Mobile platform).

BinText : TRUE

      small text extractor utility that can
            Extracts text from any kind of file
            Includes the ability to find
                  -  plain ASCII text,
                  -  Unicode (double byte ANSI) text
                  -  Resource strings,

            Provides useful information for each item in
                the optional "advanced" view mode.


--------------------

Which of the following analysis techniques
involves going through the
    executable binary code
without actually executing it to have
    a better understanding of the malware and its purpose?

Static Malware Analysis:  (TRUE)
    It also known as code analysis, involves going through
    the executable binary code without actually executing it to have
    a better understanding of the malware and its purpose.
    The general static scrutiny involves analysis of malware
    without executing the code or instructions.
    The process includes use of different tools and techniques to determine
    the malicious part of the program or a file.

Spectrum Analysis:
    An attacker can use spectrum analyzers to discover
    the presence of wireless networks.
    Spectrum analysis of wireless network helps an attacker to actively monitor
    the spectrum usage in a particular area and
    detect the spectrum signal of target network.
    It also helps the attacker to measure the power of
    the spectrum of known and unknown signals.

Dynamic Malware Analysis:
    It also known as behavioral analysis, involves executing the malware code to know
    how it interacts with the host system and its impact on it after infecting the system.
    Dynamic analysis involves execution of malware to examine its conduct, operations
    and identifies technical signatures that confirm the malicious intent.

System Baselining:
    Baselining refers to the process of capturing system state (taking snapshot of the system) at the time
    the malware analysis begins that can be used to
    compare the system’s state after executing the malware file.
    This will help to understand the changes malware has made across the system.
    System baseline includes recording details of the
          file system, registry,
          open ports, network activity, etc.

------------------------

Identify the monitoring tool that exhibits the following features:

Reliable capture of process details, including image path, command line, user and session ID.
Configurable and moveable columns for any event property.
Filters can be set for any data field, including fields not configured as columns.
Advanced logging architecture scales to tens of millions of captured events and gigabytes of log data.
Process tree tool shows the relationship of all processes referenced in a trace.
Native log format preserves all data for loading in a different Process Monitor instance



Process Monitor:(TRUE)
      Monitoring tool for Windows that shows
                Real-time file system,
                Registry,
                process/thread activity.

Features:

More data captured for operation input and output parameters.
Non-destructive filters allow you to set filters without losing data.
Capture of thread stacks for each operation makes it possible in many cases
    to identify the cause of an operation.
Reliable capture of process details, including
          image path,
          command line,
          user and session ID.
Configurable and moveable columns for any event property.
Filters can be set for any data field, including
          fields not configured as columns.
Advanced logging architecture scales to tens of millions of
          Captured events and
          Gigabytes of log data.
Process tree tool shows the relationship of all processes referenced in a trace.
Native log format preserves all data for loading in a different Process Monitor instance.


Netstat:
            displays  : active TCP connections,
                        ports on which the computer is listening,
                        Ethernet statistics,
                        IP routing table,
                        IPv4 statistics (for the IP, ICMP, TCP, and UDP protocols),
                        IPv6 statistics (for the IPv6, ICMPv6,
                                              TCP over IPv6,
                                          and UDP over IPv6 protocols).

TCPView:
        Windows program that shows detailed listings of
              all TCP and UDP endpoints on the system, including :
                    - local & remote addresses,
                    - state of TCP connections.
        Provides a subset of the Netstat program that ship with Windows.

IDA Pro:
      Multi-platform disassembler and debugger that
              Explores binary programs, for which source code is not always available,
                to create maps of their execution.
              Shows the instructions in the same way as a processor executes them
                in a symbolic representation called assembly language.
              Thus, it is easy for you to find the harmful or malicious processes.

-------------------

Ramon is a security professional for xsecurity.
During an analysis process, he has identified a suspicious .exe file.
Ramon executed the suspicious malicious file in a sandbox environment
where the malware cannot affect other machines in the network.
What type of analysis does Ramon conduct?


Sheep Dipping

Preparing Testbed

Static Malware Analysis

Dynamic Malware Analysis :
        Also known as behavioral analysis,
        Involves executing the malware code to know
                      How it interacts with the host system and
                      Its impact on the system after it has been infected.
                      In dynamic analysis, the malware will be executed on
                      a system to understand its behavior after infection.
                      This type of analysis requires safe environment such as
                              virtual machines
                              sandboxes
                        to deter the spreading of malware.
---------------------

Which of the following processes refers to
      taking a snapshot of the system at the time the malware analysis begins?


Windows services monitoring

API call monitoring

System baselining : TRUE

    Process of capturing system state (taking snapshot of the system)
          at the time the malware analysis begins
          that can be used to compare
                system’s state after executing the malware file.
     Help to understand  changes malware has made across the system.
    System baseline includes recording details of
          - file system,
          - registry,
          - open ports,
          - network activity,
           and so on.

Sandboxing


-------------------

Which of the following .dll file
  is used by the Zeus Trojan
    to access & manipulate
      Service Manager and
      Registry
            on a victim machine?


n32dll.dll

User32.dll

Kernel32.dll

Advapi32.dll : TRUE

A ZeuS trojan consists of 3 main .dll files packed in UPX format,

            - Kernel32.dll,
            - Advapi32.dll,
            - user32.dll.

These 3 .dll files are required by the trojan to perform the following actions:

Kernel32.dll – To access/manipulate
                  memory files & hardware

Advapi32.dll – To access/manipulate
                  Service Manager and Registry

User32.dll –   To display and manipulate
                  graphics

N32dll.dll:    Type of DLL file associated with
                    3rd-Party Application
                developed by Windows Software Developer
                for the Windows OS.

-----------------------------

Which of the following windows service vulnerability does the WannaCry ransomware exploit during the attack on any windows machine?


SMB : WannaCry ransomware spreads through

        - malicious e-mail attachments a
        - the same LAN by using a
                          Windows SMB (server message block) vulnerability via
                          port 445 (Microsoft Security Bulletin MS17-010).
    WannaCry uses the
                        RSA AES encryption algorithm to
                                encrypt contents on infected systems
                                change the wallpaper of the system desktop demanding payment in bitcoins.

DNS

SNMP

SMTP

---------------------------
Which of the following Backdoors
is used by the WannaCry ransomware to perform
      -  remote code execution
      -  further propagation
on a victim machine?


Doublepulsar : TRUE
              Backdoor  used by  WannaCry ransomware to perform
                    - remote code execution
                    - further propagation
               on a victim machine.

EternalBlue :

          Ransomware Package that
                Wanacry uses for
                    - deploying the backdoor

Kovter

satanz

------------

By conducting which of the following monitoring techniques can a
security professional identify
the presence of any malware that manipulates
      HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services registry keys
to hide its processes?

Windows services monitoring : TRUE

      traces malicious services initiated by the malware.
      Since malware employs rootkit techniques to manipulate
              HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services registry keys
        to hide its processes,
      Windows service monitoring can be used to identify such manipulations.

Registry monitoring :
      Examine the changes made to the system’s registry by malware.

Startup programs monitoring :
    detect suspicious
        - startup programs &
        - processes.

Process monitoring :
     scan for suspicious processes

----------------

In which of the following online services can a security analyst upload the suspicious file to identify whether the file is a genuine one or a malicious one?


VirusTotal.com ; TRUE
  online web service that is effectively used to
      - analyze suspicious
          files & URLs,
      - facilitates the detection of
          viruses, worms, Trojans, ....

domainsearch.com : online web services that are mostly used to identify the domain information about any organization

Whois.com : online web services that are mostly used to identify the domain information about any organization

Netcraft.com : online web services that are mostly used to identify the domain information about any organization


-----------------
